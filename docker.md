---
title: Что такое Docker?
name: docker
author: igsekor
co-authors:
designers:
contributors:
summary:
  - докер
  - контейнер
  - container
---

## Кратко

Docker — это технология, которая позволяет создавать и использовать приложения в изолированном окружении. В основе Docker лежит амбициозная идея: если работает у вас, будет работать где угодно.

Docker чаще всего применяется для разработки, тестирования и развертывания серверных приложений на базе операционной системе Linux, но может использоваться и в мире фронтенда:
* для сборки [бандлов](/js/tools/bundlers);
* для [статического анализа кода](/js/tools/static-analysis);
* для модульного и интеграционного тестирования приложений;
* для тестирования пользовательского интерфейса;
* для подготовки ресурсов приложения (картинок, шрифтов, иконок и пр.);
* для воспроизводимых экспериментов с новыми технологиями и демок;
* для создания изолированного окружения разработчика.

## Как начать

[Установите Docker на свой компьютер](https://docs.docker.com/engine/install/) (хост). Вы также можете поиграть с Docker в [песочнице](https://labs.play-with-docker.com). После запуска Docker в системе можно проверить его работоспособность с помощью графического интерфейса [Dashboard](https://docs.docker.com/desktop/dashboard/) или команды в терминале:

```bash
docker --version
```

У разработчиков Doсker есть готовая демка, которую можно запустить следующим образом:

```bash
docker run -d -p 80:80 docker/getting-started
```

После загрузки образа, сборки и запуска контейнера на его основе, вы можете открыть в браузере стартовую документацию Docker по адресу [http://localhost](localhost). Готовое веб-приложение — наиболее популярный кейс использования.

## Как понять

### Службы

Docker Engine (движок) — клиент-серверное приложение, которое нужно для управления объектами Docker и включает в себя три компонента: Docker Daemon (сервер), Docker API (интерфейс) и Docker CLI (консольный клиент).

Архитектура Docker представлена на рисунке:

![Архитектура Docker](https://docs.docker.com/engine/images/architecture.svg)

Все операции с объектами Docker (образы, контейнеры, тома, внутренняя виртуальная локальная сеть) реализуются с помощью демона dockerd (Docker Daemon), запущенного на вашем компьютере (Docker Host). Работа этого демона основана на технологии контейниризации [LXC](https://linuxcontainers.org/lxc/introduction/).

С помощью [Docker API](https://docs.docker.com/engine/api/) реализуется программный интерфейс, благодаря которому консольный клиент Docker CLI или другие приложения могут получить доступ к системе мониторинга и управления Docker объектами. Система команд консольного клиента Docker CLI позволяет полностью покрыть всю функциональность Docker.

Хранение образов может быть локальным или удаленным. Демон отвечает за локальное хранение. Хранение образов на сервере осуществляется с помощью службы [Docker Registry](https://docs.docker.com/registry/). Существуют публичные реестры образов, среди которых:

* [Docker Hub](https://hub.docker.com/);
* [Google Cloud Container Registry](https://cloud.google.com/container-registry);
* [Azure Container Registry](https://azure.microsoft.com/services/container-registry);
* [IBM Cloud Container Registry](https://www.ibm.com/cloud/container-registry);
* [Oracle Cloud Infrastructure Container Registry](https://www.oracle.com/cloud-native/container-registry/);
* [Yandex Container Registry](https://cloud.yandex.com/services/container-registry).

Docker Desktop — пакет приложений, включающий виртуальную машину для работы с движком (Docker Engine), визуальный интерфейс (Dashboard), консольный клиент (Docker CLI), инструменты для работы с реестром Docker Hub и пр.

Для платформы Mac и Windows невозможно использовать механизм контейнеризации Linux напрямую. Для этого необходимо использовать виртуальную машину (гипервизор) с установленным на нее ядром Linux. Контейнеры [LXC](https://linuxcontainers.org/lxc/introduction/) реализуются на уровне ядра. Дополнительная специфичность закладывается установкой надстроек контейнера с конкретной операционной системой Linux на борту. Такая архитектура позволяет снизить потребление ресурсов компьютера на Mac или Windows.

Docker Desktop обеспечивает следующие функции:

* Возможность контейнеризации и совместного использования любого приложения на любой облачной платформе, на нескольких языках и фреймворках;
* Простая установка и настройка полной среды разработки Docker;
* Возможность управления кластером [Kubernetes](https://kubernetes.io);
* В Windows возможность переключения между средами Linux и Windows Server для создания приложений;
* Возможность работать изначально на Linux через WSL 2 на машинах Windows;
* Установка тома для кода и данных, включая уведомления об изменении файлов и легкий доступ к запущенным контейнерам в локальной сети;
* Разработка и отладка в контейнере с поддерживаемыми IDE.

### Объекты

Docker Image (образ) — прототип будущего котейнера, содержащий его конфигурацию и набор файлов приложения.

Конфигурация может быть описана в файлах конфигурации. Как правило, это Dockerfile или docker-compose.yml.

Конфигурационный файл всегда начинается с объявления родительского образа, имя которого прописывается после директивы `FROM`. Для указания варианта сборки базового образа к имени может быть добавлен тэг через двоеточие. Дальше идут настройки.

Например, вы можете упаковать свое NodeJS приложения в контейнер, добавив в него файл Dockerfile:

```bash
FROM node:12

# Создание директории приложения
WORKDIR /app

# Установка зависимостей, учитывая package.json и package-lock.json
COPY package*.json ./

RUN npm i

# Сборка проекта, если есть необходимость
# RUN npm ci --only=production

# Копирование исходного кода приложения
COPY . .

EXPOSE 8080
CMD [ "node", "app.js" ]
```

и выполнив команду

```bash
docker build -t app .
```

После ключа `-t` вы можете задать имя образа (здесь `app` выбрано в качестве имени образа). Точка в конце означает, что образ собирается из текущей папки. Именем конфигурационного файла по умолчанию является Dockerfile. После сборки образа вы сможете запустить контейнер на его основе с приложением внутри него. Таким образом, сохраняется изолированное и воспроизводимое окружение.

Docker Container (контейнер) — собранное приложение в изолированном окружении, в соответствии с конфигурацией образа.

Контейнер — это приложение в изолированном окружении. Окружение формируется послойно. Каждый новый слой расширяет функционал предыдущего.

Файловая система контейнера — стековая ([Union File Systems](https://www.terriblecode.com/blog/how-docker-images-work-union-file-systems-for-dummies/)). Каждая ветвь файловой системы — каталоги и файлы отдельного слоя. В последствии они накладываются друг на друга, образуя единое целое, что позволяет избежать создания отдельных копий слоев.

Docker Volume (том) — папка, которую можно примонтировать к контейнерам в качестве внешней. Папка может быть связана с конкретной папкой на вашем компьютере.

Тома необходимы для хранения файлов конфигурации, критических с точки зрения безопасности, файлов баз данных, файлов, которые нельзя удалять после окончания работы приложения.

В качестве тома можно примонтировать папку и с вашего компьютера. Но это не совсем правильное использование, которое может снижать безопасность как вашей системы, так и приложения.

Docker Network (сеть) — виртуальная локальная сеть, которая позволяет совместно использовать несколько запущенных контейнеров и/или сопрягать запущенный контейнер с вашим компьютером).

В основном вы будете использовать три основных режима работы сетевой инфраструктуры Docker. По умолчанию виртуальная сеть (сетевая подсистема) использует режим `bridge`. Это означает, что все контейнеры могут взаимодействовать между собой подобно тому, как это реализуется в связки веб-сервера и СУБД. Режим `host` используется для доступа к локальному сетевому окружению на вашем компьютера. Есть еще режим `none`, в котором сеть для контейнеров полностью отключена.

### Инструменты

Docker Hub — официальный реестр образов Docker.

Хранение образов осуществляется с помощью службы [Docker Registry](https://docs.docker.com/registry/). Каждый может бесплатно создавать публичные репозитории образов и один приватный репозиторий.

Существуют официальные образы Docker для многих платформ и языков, они часто обновляются и являются относительно безопасными. Для фронтендера будут интересны:

* [Node](https://hub.docker.com/_/node);
* [Express with compatible of MongoDB](https://hub.docker.com/_/mongo-express);
* [Drupal](https://hub.docker.com/_/drupal);
* [Python](https://hub.docker.com/_/python);
* [PHP](https://hub.docker.com/_/php);
* [Ruby](https://hub.docker.com/_/ruby);

Docker CLI — консольный клиент, позволяющий управлять Docker через интерфейс командной строки.

Консольный клиент содержит ряд команд для управления объектами Docker. Список основных команд можно прочитать в документации:
* [docker ps](https://docs.docker.com/engine/reference/commandline/ps/);
* [docker run](https://docs.docker.com/engine/reference/commandline/run/);
* [docker image](https://docs.docker.com/engine/reference/commandline/image/);
* [docker container](https://docs.docker.com/engine/reference/commandline/container/);
* [docker volume](https://docs.docker.com/storage/volumes/).

## Как пользоваться

Ключи командного интерфейса Docker CLI хорошо проработаны, имеют подобное поведение с точностью до функции. Например, дополнительный ключ `prune` позволяет удалять неиспользуемые объекты. Ключ `rm` служит для удаления, а ключ `ls` для просмотра объектов. Объекты обязательно имеют уникальное имя. Если пользователь не именует объект, то имя формируется с помощью хэш-функции. Если пользователь попытается создать объект одного и того же типа с одинаковым именем, в этом ему будет отказано.

Наиболее популярные функции Docker CLI:

Мониторинг запущенных контейнеров;

Для просмотра запущенных контейнеров используется команда:

```bash
docker ps
```

Если вы хотите увидеть не только запущенные в настоящий момент контейнеры, но и уже остановленные, необходимо использовать ключ `-a`:

```bash
docker ps -a
```

Ключ `-s` служит для вывода количества дискового пространства, которое использует каждый запущенный контейнер:

```bash
docker ps -s
```

Если список запущенных в настоящий момент контейнеров или уже остановленных слишком большой, можно использовать ключ `-f` для фильтрации. Например, для фильтрации списка запущенных контейнеров по именам, содержащим hello, необходимо выполнить команду:

```bash
docker ps -f name=hello
```

Полный список ключей для команды `docker ps` доступен в [документации](https://docs.docker.com/engine/reference/commandline/ps/).

Запуск контейнеров;

Для запуска контейнера, который доступен локально или на Docker Hub, необходимо выполнить команду:

```bash
docker run --name test -i -t hello
```

Ключ `--name` используется для установки имени запущенного контейнера. Ключи -i и -t указывают, что для запуска контейнера будет использоваться [стандартный поток ввода](https://ru.wikipedia.org/wiki/Стандартные_потоки) и [терминала TTY](https://ru.wikipedia.org/wiki/TTY-абстракция) соответственно. Для того чтобы при запуске контейнера примонтировать том, который будет связан с папкой на вашем компьютере, а потом получить доступ к контейнеру через терминал, необходимо выполнить команду:

```bash
docker run -t -i --mount type=bind,src=/data,dst=/data hello bash
```

Полный список ключей для команды `docker run` доступен в [документации](https://docs.docker.com/engine/reference/commandline/run/).

Управление образами;

Вы можете получить список всех доступных локально образов с помощью команды:

```bash
docker image ls
```

Ключи `prune`, `rm` действуют обычным способом, позволяя удалить неиспользуемые или конкретные образы соответвенно. Для работы с реестром необходимо использовать следующие команды:

```bash
# Для загрузки образа с именем hello из реестра (Docker Hub)
docker image pull hello

# Для загрузки образа с именем hello в реестр (Docker Hub)
docker image push hello
```

Чтобы получить о контейнере hello полную информацию, необходимо применить команду:

```bash
docker image inspect hello
```

Чтобы собрать контейнер из текущей папки, с учетом конфигурации в файле Dockerfile, расположенном в этой же папке, необходимо использовать команду:

```bash
docker image build .
```

Полный список ключей для команды `docker image` доступен в [документации](https://docs.docker.com/engine/reference/commandline/image/).

Управление контейнерами;

Наиболее используемыми командами будут команды запуска и остановки контейнеров:

```bash
# Команда для запуска контейнера
docker container start

# Команда для перезапуска контейнера
docker container restart

# Команда для остановки контейнера
docker container stop

# Команда для постановки контейнера на паузу
docker container pause
```

Полный список ключей для команды `docker container` доступен в [документации](https://docs.docker.com/engine/reference/commandline/container/).

Управление томами.

Просмотр списка томов на вашем локальном доступен по команде:

```bash
docker volume ls
```

Создать новый том можно с помощью команды `docker volume create`. К примеру, для создания тома с именем `hello`, необходимо выполнить команду:

```bash
docker volume create hello
```

Вы можете получить исчерпывающую информацию о томе с помощью команды:

```bash
docker volume inspect hello
```

Ключ `ls` используется для просмотра всех томов, которые можно отфильтровать с помощью дополнительного ключа `-f`.

```bash
# Вывод всего списка томов
docker volume ls

# Вывод списка томов, отфильтрованного по имени
docker volume ls -f name=hello
```

Полный список ключей для команды `docker volume` доступен в [документации](https://docs.docker.com/engine/reference/commandline/volume/).
